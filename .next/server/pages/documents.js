"use strict";(()=>{var e={};e.id=976,e.ids=[976,660],e.modules={3069:(e,t,s)=>{s.r(t),s.d(t,{config:()=>y,default:()=>h,getServerSideProps:()=>v,getStaticPaths:()=>j,getStaticProps:()=>f,reportWebVitals:()=>b,routeModule:()=>k,unstable_getServerProps:()=>P,unstable_getServerSideProps:()=>T,unstable_getStaticParams:()=>S,unstable_getStaticPaths:()=>w,unstable_getStaticProps:()=>N});var a={};s.r(a),s.d(a,{default:()=>g});var r=s(7093),i=s(5244),l=s(1323),n=s(2899),d=s.n(n),o=s(3893),c=s(997),m=s(6689),x=s(1163);function u(){let[e,t]=(0,m.useState)(null),[s,a]=(0,m.useState)(!1),[r,i]=(0,m.useState)(null),[l,n]=(0,m.useState)(0),[d,o]=(0,m.useState)("BANK_STATEMENT"),[u,p]=(0,m.useState)(""),g=(0,x.useRouter)(),h=async e=>new Promise((t,s)=>{let a=new FileReader;a.onload=()=>{"string"==typeof a.result?t(a.result):s(Error("Failed to read file"))},a.onerror=()=>s(a.error),a.readAsDataURL(e)}),f=async t=>{if(t.preventDefault(),!e){i("Please select a file to upload");return}a(!0),i(null),n(0);try{let t=setInterval(()=>{n(e=>e>=30?(clearInterval(t),e):e+5)},200);p("Preparing document...");try{await h(e)}catch(e){console.warn("File preview generation failed:",e)}clearInterval(t),n(40),p("Analyzing document with Gemini AI...");let s=setInterval(()=>{n(e=>e>=90?(clearInterval(s),e):e+5)},300),a=await fetch("/api/documents/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:e.name,documentType:d,textContent:`Document type: ${d}`})});if(clearInterval(s),n(100),p("Processing complete!"),!a.ok){let e=`Server error: ${a.status}`;try{let t=await a.json();e=t.error||t.details||e}catch(t){e=a.statusText||e}throw Error(e)}let r=await a.json();if(r.document&&r.document.id)setTimeout(()=>{g.push(`/documents/${r.document.id}`)},500);else throw Error("Invalid response from server")}catch(e){console.error("Upload error:",e),i(e instanceof Error?e.message:"An unexpected error occurred"),a(!1)}};return c.jsx("div",{className:"mt-4",children:c.jsx("form",{onSubmit:f,className:"space-y-6",children:(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,c.jsxs)("div",{className:"mb-4",children:[c.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Upload Financial Document"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Upload your financial documents for automatic processing and analysis with Gemini AI."})]}),(0,c.jsxs)("div",{className:"mb-4",children:[c.jsx("label",{htmlFor:"documentType",className:"block text-sm font-medium text-gray-700",children:"Document Type"}),(0,c.jsxs)("select",{id:"documentType",name:"documentType",value:d,onChange:e=>{o(e.target.value)},className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[c.jsx("option",{value:"BANK_STATEMENT",children:"Bank Statement"}),c.jsx("option",{value:"INVOICE",children:"Invoice"}),c.jsx("option",{value:"RECEIPT",children:"Receipt"}),c.jsx("option",{value:"OTHER",children:"Other"})]})]}),(0,c.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,c.jsxs)("div",{className:"space-y-1 text-center",children:[c.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:c.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,c.jsxs)("div",{className:"flex text-sm text-gray-600 justify-center",children:[(0,c.jsxs)("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none",children:[c.jsx("span",{children:"Upload a file"}),c.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",onChange:e=>{if(e.target.files&&e.target.files[0]){let s=e.target.files[0];if(s.size>10485760){i("File size exceeds 10MB limit");return}if(!["application/pdf","image/jpeg","image/png","image/gif"].includes(s.type)&&!s.name.endsWith(".pdf")&&!s.name.endsWith(".jpg")&&!s.name.endsWith(".jpeg")&&!s.name.endsWith(".png")&&!s.name.endsWith(".gif")){i("File type not supported. Please upload PDF, JPG, PNG, or GIF");return}t(s),i(null)}},accept:".pdf,.jpg,.jpeg,.png,.gif",disabled:s})]}),c.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),c.jsx("p",{className:"text-xs text-gray-500",children:"PDF, JPG, JPEG, PNG, GIF up to 10MB"})]}),e&&c.jsx("div",{className:"mt-4 flex items-center justify-center",children:(0,c.jsxs)("div",{className:"text-sm text-gray-900 bg-gray-100 px-3 py-1 rounded-full",children:[e.name," (",(e.size/1024/1024).toFixed(2)," MB)"]})})]}),s&&c.jsx("div",{className:"mt-4",children:(0,c.jsxs)("div",{className:"relative pt-1",children:[(0,c.jsxs)("div",{className:"flex mb-2 items-center justify-between",children:[c.jsx("div",{children:c.jsx("span",{className:"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-indigo-600 bg-indigo-200",children:l<40?"Preparing Document":l<90?"Analyzing with Gemini AI":"Processing Complete"})}),c.jsx("div",{className:"text-right",children:(0,c.jsxs)("span",{className:"text-xs font-semibold inline-block text-indigo-600",children:[l,"%"]})})]}),c.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-indigo-200",children:c.jsx("div",{style:{width:`${l}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-indigo-500 transition-all duration-300"})}),u&&c.jsx("p",{className:"text-xs text-gray-600",children:u})]})}),r&&c.jsx("div",{className:"mt-4 text-sm text-red-600 bg-red-50 p-3 rounded-md",children:r}),c.jsx("div",{className:"mt-4",children:c.jsx("button",{type:"submit",disabled:!e||s,className:`w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${!e||s?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}`,children:s?(0,c.jsxs)("span",{className:"flex items-center",children:[(0,c.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Upload Document"})})]})})})}var p=s(7838);function g(){let[e,t]=(0,m.useState)([]),[s,a]=(0,m.useState)(null),[r,i]=(0,m.useState)([]),l=async(e,t)=>{i(r.map(s=>s.id===e?{...s,...t}:s))};return(0,c.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,c.jsxs)("div",{className:"mb-8",children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Documents"}),c.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Upload and manage your financial documents"})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-2",children:[(0,c.jsxs)("div",{children:[c.jsx(u,{}),(0,c.jsxs)("div",{className:"mt-8",children:[c.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Documents"}),c.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:c.jsx("ul",{className:"divide-y divide-gray-200",children:e.map(e=>c.jsx("li",{children:c.jsx("button",{onClick:()=>a(e),className:"block hover:bg-gray-50 w-full text-left",children:(0,c.jsxs)("div",{className:"px-4 py-4 sm:px-6",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[c.jsx("p",{className:"text-sm font-medium text-indigo-600 truncate",children:e.fileName}),c.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:c.jsx("p",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"completed"===e.processingStatus?"bg-green-100 text-green-800":"processing"===e.processingStatus?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:e.processingStatus})})]}),(0,c.jsxs)("div",{className:"mt-2 sm:flex sm:justify-between",children:[c.jsx("div",{className:"sm:flex",children:c.jsx("p",{className:"flex items-center text-sm text-gray-500",children:e.documentType})}),c.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:(0,c.jsxs)("p",{children:["Uploaded on ",e.createdAt.toLocaleDateString()]})})]})]})})},e.id))})})]})]}),c.jsx("div",{children:s?c.jsx(p.Z,{document:s,transactions:r,onUpdateTransaction:l}):c.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:c.jsx("p",{className:"text-gray-500 text-center",children:"Select a document to view details"})})})]})]})}let h=(0,l.l)(a,"default"),f=(0,l.l)(a,"getStaticProps"),j=(0,l.l)(a,"getStaticPaths"),v=(0,l.l)(a,"getServerSideProps"),y=(0,l.l)(a,"config"),b=(0,l.l)(a,"reportWebVitals"),N=(0,l.l)(a,"unstable_getStaticProps"),w=(0,l.l)(a,"unstable_getStaticPaths"),S=(0,l.l)(a,"unstable_getStaticParams"),P=(0,l.l)(a,"unstable_getServerProps"),T=(0,l.l)(a,"unstable_getServerSideProps"),k=new r.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/documents",pathname:"/documents",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:a})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[567,424,899,152],()=>s(3069));module.exports=a})();